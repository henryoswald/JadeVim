This is totally riped from Joshua Borton here http://www.vim.org/scripts/script.php?script_id=3192 but has been made simpler as I found the indenting didn't work how I would like it (simple please!).
